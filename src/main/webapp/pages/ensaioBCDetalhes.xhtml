<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="/templates/template.xhtml">

	<ui:define name="titulo">
		<title>SGLabCon | Laboratório</title>
	</ui:define>

	<ui:define name="conteudo">
		<h:form id="formDetalhe">
			<p:fieldset id="fs" legend="Ensaio de Blocos de Concreto - Detalhes">
				<p:panelGrid id="painelDetalhe" columns="2">

					<p:outputLabel value="Laboratorista: " />
					<h:outputText value="#{ensaioBConcretoBean.ensaioDetalhe.usuario.nomeCompleto}" />

					<p:outputLabel value="Codigo:" />
					<h:outputText value="#{ensaioBConcretoBean.ensaioDetalhe.codigo}" />

					<p:outputLabel value="Idade do ensaio:" />
					<h:outputText
						value="#{ensaioBConcretoBean.ensaioDetalhe.idade} dias" />

					<p:outputLabel value="Data de fabricação:" />
					<h:outputText
						value="#{ensaioBConcretoBean.ensaioDetalhe.dataFabricacao}">
						<f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss" />
					</h:outputText>

					<p:outputLabel value="Lote:" />
					<h:outputText value="#{ensaioBConcretoBean.ensaioDetalhe.lote}" />

					<p:outputLabel value="Classe de resistência:" />
					<h:outputText
						value="#{ensaioBConcretoBean.ensaioDetalhe.classeResistencia.nome}" />

					<p:outputLabel value="Tipo de Produto:" />
					<h:outputText
						value="#{ensaioBConcretoBean.ensaioDetalhe.tipoProdutoBC.descricao}" />

					<p:outputLabel value="Qtd. de amostras:" />
					<h:outputText
						value="#{ensaioBConcretoBean.ensaioDetalhe.qtdAmostras}" />

					<p:outputLabel value="Dimensão Nominal:" />
					<h:outputText
						value="#{ensaioBConcretoBean.ensaioDetalhe.tipoProdutoBC.dimensaoNominal}" />

					<p:outputLabel value="Fator de Correção:" />
					<h:outputText
						value="#{ensaioBConcretoBean.ensaioDetalhe.fatorCorrecao}" />

					<p:outputLabel value="Cliente:" />
					<h:outputText
						value="#{ensaioBConcretoBean.ensaioDetalhe.cliente.nomeFantasia}" />
				</p:panelGrid>

				<h3>Observações:</h3>
				<p:panelGrid columns="1">
					<h:outputText
						value="#{ensaioBConcretoBean.ensaioDetalhe.observacoes}"
						escape="false" />
				</p:panelGrid>

				<br />

				<p:carousel id="carousel" value="#{ensaioBConcretoBean.amostras}"
					headerText="Amostra" var="amostra" itemStyle="height:200px"
					numVisible="1" easing="easeOutBounce" style="width:450px"
					circular="true">
					<p:panelGrid columns="2" style="width:100%"
						columnClasses="label,value">

						<h:outputLabel value="Codigo da Amostra:" />
						<h:outputText value="#{amostra.codigo}" />
						<h:outputLabel value="Indentificação da Amostra:" />
						<h:outputText value="#{amostra.identificacao}" />
						<h:outputLabel value="Realizado por:" />
						<h:outputText value="#{amostra.usuario.nomeCompleto}" />
						<h:outputLabel value="Data:" />
						<h:outputText value="#{amostra.data}">
							<f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss" />
						</h:outputText>
						<h:outputLabel value="Força Aplicada (kN):" />
						<h:outputText value="#{amostra.forcaAplicada}" />
						<p:outputLabel value="Conversão Força aplicada (MPa):" />
						<h:outputText value="#{amostra.conversaoFA}" />
						<p:outputLabel value="Status:" />
						<h:outputText value="#{amostra.statusFormatado}"
							style="color:#{ensaioBConcretoBean.alterarCorStatus(amostra)}" />
					</p:panelGrid>
				</p:carousel>

				<br />
				<br />

				<p:panelGrid columns="3">
					<p:commandButton value="Nova Amostra"
						actionListener="#{ensaioBConcretoBean.novaAmostra}"
						oncomplete="PF('novaAmostraDialogo').show();"
						update=":formCadastro:painel">
						<f:actionListener
							type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />
					</p:commandButton>
					<p:commandButton value="Imprimir" type="button"
						icon="ui-icon-print">
						<p:printer target="formDetalhe" />
					</p:commandButton>
				</p:panelGrid>
			</p:fieldset>

		</h:form>

		<p:dialog header="Nova Amostra" widgetVar="novaAmostraDialogo"
			closable="false" draggable="false" resizable="false" modal="true">
			<h:form id="formCadastro">

				<p:panelGrid id="painel" columns="2">

					<p:outputLabel for="laboratorista" value="Laboratorista" />
					<h:outputText id="laboratorista"
						value="#{autenticacaoBean.usuarioLogado.nomeCompleto}" />
					<p:outputLabel for="identificacao"
						value="Indentificação da Amostra" />
					<p:inputText id="identificacao" maxlength="50" size="30"
						value="#{ensaioBConcretoBean.amostraBConcreto.identificacao}" />
					<p:outputLabel for="forcaAplicada" value="Força Aplicada (kN)" />
					<p:inputNumber id="forcaAplicada" maxlength="50" size="30"
						value="#{ensaioBConcretoBean.amostraBConcreto.forcaAplicada}"
						required="true"
						requiredMessage="O campo 'Força Aplicada' é obrigatório">
						<p:ajax listener="#{ensaioBConcretoBean.converterUnidades}"
							update=":formCadastro:conversaoFA :formCadastro:status"
							event="keyup" />
					</p:inputNumber>
					<p:outputLabel for="conversaoFA"
						value="Conversão Força aplicada (mPA)" />
					<h:outputText id="conversaoFA"
						value="#{ensaioBConcretoBean.amostraBConcreto.conversaoFA}" />
					<p:outputLabel for="status" value="Status" />
					<h:outputText id="status"
						style="color:#{ensaioBConcretoBean.alterarCorStatus()}"
						value="#{ensaioBConcretoBean.amostraBConcreto.statusFormatado}" />

				</p:panelGrid>

				<h:panelGrid columns="2">
					<p:commandButton value="Registrar Amostra"
						actionListener="#{ensaioBConcretoBean.salvarAmostra()}"
						update=":mensagem :formCadastro:painel :formDetalhe:carousel" />
					<p:commandButton value="Cancelar"
						oncomplete="PF('novaAmostraDialogo').hide();" />
				</h:panelGrid>
			</h:form>
		</p:dialog>

	</ui:define>
</ui:composition>